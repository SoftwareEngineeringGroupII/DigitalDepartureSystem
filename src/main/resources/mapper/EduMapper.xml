<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.digitaldeparturesystem.mapper.EduMapper">

    <!--查询学生基本信息和离校状态：教务处列表-->
   <!-- <select id="findAllByPage" resultType="java.util.Map">

    </select>-->

    <!--分页查询所有离校审核情况-->
    <select id="listAllEdu" resultType="java.util.Map">
        select s.stuNumber,s.stuName,s.stuType,s.stuDept,e.eduStatus from edu e,student s where e.stuID=s.stuID;
    </select>

    <!--根据学号查询学生的离校详情-->
    <select id="findProcess" resultType="java.util.Map">
        select p.libStatus from process p
    </select>

    <!--设置学生的离校进度表 //一卡通 -->
    <update id="setCardStatus" parameterType="String">
        update process set cardStatus=1 where stuID=(select stuID from student where stuNumber=#{stuNumber})
    </update>

    <!--设置学生离校进度表 //财务处-->
    <update id="setFinanceStatus" parameterType="String">
         update process set financeStatus=1 where stuID=(select stuID from student where stuNumber=#{stuNumber})
    </update>

    <!--设置学生离校进度表 //后勤处-->
    <update id="setDormStatus" parameterType="String">
         update process set dormStatus=1 where stuID=(select stuID from student where stuNumber=#{stuNumber})
    </update>

    <!--设置学生离校进度表 //图书馆-->
    <update id="setLibStatus" parameterType="String">
        update process set libStatus=1 where stuID=(select stuID from student where stuNumber=#{stuNumber})
    </update>

    <!--查询某个学生是否存在-->
    <select id="findStuByStuNumber" parameterType="String" resultType="com.digitaldeparturesystem.pojo.Student">
        select * from student where stuNumber=#{stuNumber}
    </select>

    <!--根据学号查询某个学生离校(列表)-->
    <select id="findStuEduByStuNumber" resultType="java.util.Map">
         select s.stuNumber,s.stuName,s.stuDept,s.stuType,e.eduStatus from student s ,edu e where s.stuID=e.stuID and s.stuNumber=#{stuNumber}
    </select>

    <!--根据学号查询某个学生的离校信息详情(学生基本信息+学分要求+离校流程)-->
    <select id="getStuBasicInfo" resultType="com.digitaldeparturesystem.pojo.StuBasicInfo">
          select s.stuNumber,s.stuName,s.stuNation,s.stuFeature,s.stuSex,s.stuType,s.stuDept,s.stuSpecialty,
          s.stuCredit,s.stuInDate,s.stuOutDate,s.stuStatus,s.stuAddress,s.stuPhoneNumber,s.stuContact,s.stuPhoto
          from student s where stuNumber=#{stuNumber}
    </select>

    <!--根据学号查询某个学生的离校信息详情(离校流程)-->
    <select id="getStuProcess" resultType="com.digitaldeparturesystem.pojo.Process">
          select p.cardStatus,p.financeStatus,p.dormStatus,p.libStatus,p.eduStatus
          from process p where stuID=(select stuID from student where stuNumber=#{stuNumber})
    </select>



</mapper>